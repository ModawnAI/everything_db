# 에뷰리띵 웹 관리자 플랫폼 상세 설계서

## 🖥️ 개요
본 문서는 에뷰리띵 웹 관리자 플랫폼의 모든 화면과 기능에 대한 상세한 설계와 Node.js 백엔드 API와의 상호작용을 설명합니다. Super Admin과 Shop Admin 두 가지 역할에 따른 차별화된 기능과 권한 관리를 포함합니다.

---

## 🏗️ 아키텍처 개요

### **기술 스택 및 프레임워크**
- **프레임워크**: React 18+ with TypeScript (타입 안전성 보장)
- **상태 관리**: Redux Toolkit (RTK) + RTK Query (API 상태 관리)
- **UI 라이브러리**: Material-UI (MUI) v5 (일관된 디자인 시스템)
- **스타일링**: Emotion + MUI Theme (styled-components 패턴)
- **차트**: Chart.js + react-chartjs-2 (데이터 시각화)
- **테이블**: MUI DataGrid (고급 테이블 기능)
- **폼 관리**: React Hook Form + Yup (폼 검증)
- **라우팅**: React Router v6 (SPA 네비게이션)
- **API 클라이언트**: RTK Query + Axios (HTTP 통신)
- **알림**: React Hot Toast (사용자 피드백)

### **프로젝트 구조 및 디렉토리**
```
src/
├── components/           # 재사용 가능한 컴포넌트
│   ├── common/          # 공통 UI 컴포넌트
│   ├── forms/           # 폼 관련 컴포넌트
│   ├── charts/          # 차트 컴포넌트
│   ├── tables/          # 테이블 컴포넌트
│   └── modals/          # 모달 컴포넌트
├── pages/               # 페이지 컴포넌트
│   ├── auth/           # 인증 관련 페이지
│   ├── dashboard/      # 대시보드 페이지
│   ├── users/          # 사용자 관리 페이지
│   ├── shops/          # 샵 관리 페이지
│   ├── reservations/   # 예약 관리 페이지
│   ├── payments/       # 결제 관리 페이지
│   ├── content/        # 컨텐츠 관리 페이지
│   └── settings/       # 설정 페이지
├── hooks/               # 커스텀 훅
├── services/           # API 서비스
├── store/              # Redux 스토어
│   ├── slices/         # Redux 슬라이스
│   └── api/            # RTK Query API
├── types/              # TypeScript 타입 정의
├── utils/              # 유틸리티 함수
├── constants/          # 상수 정의
├── styles/             # 스타일 관련
└── App.tsx            # 메인 앱 컴포넌트
```

### **데이터 플로우 아키텍처**
```
Admin Web Interface
         ↓
    React Components
         ↓
    Redux Store (RTK)
         ↓
    RTK Query API
         ↓
    Node.js Backend API
         ↓
    Supabase Database
```

---

## 🔐 인증 및 권한 시스템

### **관리자 인증 플로우**

#### **로그인 프로세스**
1. **이메일/비밀번호 입력**
   - 관리자 전용 이메일 도메인 검증
   - 비밀번호 강도 확인
   - 로그인 시도 횟수 제한 (5회)

2. **백엔드 인증 검증**
   - `user_role`이 'admin' 또는 'shop_owner'인지 확인
   - `user_status`가 'active'인지 검증
   - JWT 토큰 발급 및 저장

3. **세션 관리**
   - 토큰 자동 갱신 (30분 간격)
   - 비활성 시간 초과 감지 (1시간)
   - 로그아웃 시 토큰 무효화

#### **권한 기반 접근 제어**
```typescript
// 권한 매트릭스 정의
const PERMISSIONS = {
  SUPER_ADMIN: [
    'users:read', 'users:write', 'users:suspend',
    'shops:read', 'shops:write', 'shops:approve',
    'reservations:read', 'reservations:write',
    'payments:read', 'analytics:read',
    'settings:read', 'settings:write'
  ],
  SHOP_OWNER: [
    'own_shop:read', 'own_shop:write',
    'own_reservations:read', 'own_reservations:write',
    'own_analytics:read'
  ]
};
```

---

## 📊 Super Admin 화면 설계

### **1. Super Admin 로그인 화면**

#### **화면 구성**
- **상단 브랜딩**
  - 에뷰리띵 로고 및 "관리자 시스템" 텍스트
  - 간단한 브랜드 컬러 적용

- **로그인 폼**
  - 이메일 입력 필드 (admin@ebeautything.com 형식)
  - 비밀번호 입력 필드 (보안 강화)
  - "로그인 상태 유지" 체크박스
  - "로그인" 버튼

- **보안 정보**
  - "관리자 전용 시스템입니다" 안내 문구
  - 로그인 시도 제한 안내

#### **백엔드 API 상호작용**
```typescript
// 관리자 로그인 요청
POST /api/admin/login
Content-Type: application/json

// 요청 구조
{
  "email": "admin@ebeautything.com",
  "password": "secure_admin_password",
  "rememberMe": true
}

// 응답 구조
{
  "success": true,
  "admin": {
    "id": "uuid",
    "email": "admin@ebeautything.com",
    "name": "관리자",
    "user_role": "admin",
    "permissions": ["users:read", "users:write", ...]
  },
  "jwt_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_expires": "2024-03-15T18:00:00Z"
}
```

#### **기능 및 로직**
1. **폼 검증**
   - 이메일 형식 검증 (admin 도메인 확인)
   - 비밀번호 최소 길이 (8자 이상)
   - 필수 필드 검증

2. **보안 처리**
   - 로그인 실패 시 계정 잠금 (5회 시도 후)
   - CAPTCHA 표시 (3회 실패 후)
   - IP 기반 접근 제한

#### **UI/UX 구현 상세**
- **레이아웃**: 중앙 정렬 카드 형태, 반응형 디자인
- **폼 스타일**: MUI TextField + 포커스 애니메이션
- **로고**: 상단 중앙 배치, 브랜드 컬러 적용
- **버튼**: MUI Button + 로딩 스피너 (로그인 중)
- **에러 표시**: 폼 하단 Alert 컴포넌트
- **다크 모드**: 시스템 테마 설정 연동

### **2. Super Admin 대시보드**

#### **화면 구성**
- **상단 헤더**
  - 에뷰리띵 로고 및 관리자 시스템 제목
  - 관리자 프로필 메뉴 (이름, 로그아웃)
  - 알림 아이콘 (새 샵 신청, 긴급 이슈)

- **플랫폼 개요 카드**
  - 총 사용자 수 (성장률 포함)
  - 총 샵 수 (승인 대기 수 포함)
  - 총 예약 수 (일일/월간 비교)
  - 총 매출액 (증감률 표시)

- **시스템 상태 위젯**
  - 데이터베이스 연결 상태
  - API 응답 시간
  - 서버 리소스 사용률
  - 최근 에러 로그 요약

- **최근 활동 피드**
  - 신규 사용자 가입 (최근 10명)
  - 새 샵 입점 신청 (승인 대기 목록)
  - 고액 예약 알림 (10만원 이상)
  - 사용자 신고 접수

- **빠른 액션 버튼**
  - 샵 승인 대기 목록으로 이동
  - 사용자 관리로 이동
  - 시스템 공지 작성
  - 긴급 알림 발송

#### **백엔드 API 상호작용**
```typescript
// 대시보드 통계 조회
GET /api/admin/analytics/dashboard
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// 응답 구조
{
  "success": true,
  "overview": {
    "totalUsers": 15420,
    "userGrowthRate": 12.5,
    "totalShops": 234,
    "pendingShops": 12,
    "totalReservations": 3421,
    "dailyReservations": 45,
    "totalRevenue": 125000000,
    "revenueGrowthRate": 8.3
  },
  "systemStatus": {
    "databaseStatus": "healthy",
    "apiResponseTime": 150,
    "serverLoad": 45.2,
    "errorCount": 3
  },
  "recentActivity": [
    {
      "type": "new_user",
      "user_name": "홍길동",
      "timestamp": "2024-03-15T14:30:00Z"
    },
    {
      "type": "shop_application",
      "shop_name": "예쁜손 네일샵",
      "owner_name": "김사장",
      "timestamp": "2024-03-15T13:45:00Z"
    }
  ],
  "chartData": {
    "dailyRegistrations": [25, 30, 28, 35, 42],
    "monthlyRevenue": [45000000, 52000000, 48000000],
    "categoryDistribution": [
      {"category": "nail", "count": 120},
      {"category": "eyelash", "count": 80}
    ]
  }
}

// 시스템 알림 조회
GET /api/admin/notifications/urgent
Headers: { Authorization: "Bearer ${admin_jwt_token}" }
```

#### **기능 및 로직**
1. **실시간 데이터 업데이트**
   - 5분 간격 자동 새로고침
   - WebSocket을 통한 실시간 알림
   - 중요 지표 변화 시 즉시 업데이트

2. **데이터 시각화**
   - Chart.js를 활용한 성장률 차트
   - 색상 코딩으로 상태 구분 (녹색: 양호, 빨간색: 주의)
   - 인터랙티브 차트 (호버 시 상세 정보)

#### **UI/UX 구현 상세**
- **카드 레이아웃**: MUI Card + 그리드 시스템 (4열)
- **수치 표시**: 
  - **큰 숫자**: Typography variant="h3" + 애니메이션
  - **성장률**: 화살표 아이콘 + 색상 구분 (상승=녹색, 하락=빨간색)
  - **소수점**: 천 단위 콤마 + 한국어 단위 (만, 억)

- **차트 스타일**:
  - **라인 차트**: 사용자 증가 추세 (7일, 30일 옵션)
  - **도넛 차트**: 카테고리별 샵 분포
  - **바 차트**: 일별 예약 현황

- **알림 시스템**:
  - **뱃지**: 알림 개수 표시 (빨간 점)
  - **팝오버**: 클릭 시 알림 목록 표시
  - **우선순위**: 긴급, 중요, 일반 구분

- **반응형 디자인**:
  - **데스크톱**: 4열 그리드
  - **태블릿**: 2열 그리드
  - **모바일**: 1열 스택

### **3. 사용자 관리 화면**

#### **화면 구성**
- **상단 액션 바**
  - 페이지 제목 "사용자 관리"
  - 검색창 (이름, 이메일, 전화번호)
  - 필터 옵션 (상태, 역할, 가입일)
  - 내보내기 버튼 (CSV, Excel)

- **사용자 목록 테이블**
  - 프로필 이미지 (썸네일)
  - 이름 및 이메일
  - 전화번호 (마스킹)
  - 사용자 상태 (active, suspended, deleted)
  - 역할 (user, shop_owner, influencer)
  - 총 포인트 및 예약 수
  - 가입일 및 최근 로그인
  - 액션 버튼 (상세보기, 상태변경, 메모)

- **페이지네이션**
  - 페이지당 50개 항목
  - 이전/다음 버튼
  - 페이지 번호 직접 입력
  - 총 개수 표시

#### **백엔드 API 상호작용**
```typescript
// 사용자 목록 조회
GET /api/admin/users?page=1&limit=50&search=홍길동&status=active&role=user&sortBy=created_at&sortOrder=desc
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// 응답 구조
{
  "success": true,
  "users": [
    {
      "id": "uuid",
      "name": "홍길동",
      "email": "hong@example.com",
      "phone_number": "010-****-5678",
      "user_status": "active",
      "user_role": "user",
      "is_influencer": false,
      "total_points": 15000,
      "total_reservations": 12,
      "profile_image_url": "https://storage.url/profile.jpg",
      "created_at": "2024-01-15T09:30:00Z",
      "last_login_at": "2024-03-15T14:20:00Z"
    }
  ],
  "pagination": {
    "current_page": 1,
    "total_pages": 45,
    "total_count": 2250,
    "per_page": 50
  }
}

// 사용자 상태 변경
PUT /api/admin/users/{userId}/status
Headers: { Authorization: "Bearer ${admin_jwt_token}" }
Content-Type: application/json

// 요청 구조
{
  "status": "suspended",
  "reason": "스팸 신고 다수 접수로 인한 계정 정지"
}

// 사용자 상세 정보 조회
GET /api/admin/users/{userId}/detail
Headers: { Authorization: "Bearer ${admin_jwt_token}" }
```

#### **기능 및 로직**
1. **고급 검색 및 필터링**
   - 실시간 검색 (디바운싱 500ms)
   - 다중 필터 적용 (상태 + 역할 + 기간)
   - 정렬 옵션 (이름, 가입일, 포인트, 예약수)

2. **벌크 액션**
   - 여러 사용자 선택 (체크박스)
   - 일괄 상태 변경
   - 일괄 알림 발송

3. **데이터 내보내기**
   - CSV 형식으로 검색 결과 내보내기
   - 엑셀 형식 지원 (차트 포함)
   - 개인정보 마스킹 적용

#### **UI/UX 구현 상세**
- **테이블 컴포넌트**: MUI DataGrid (고급 기능)
  - **정렬**: 컬럼 헤더 클릭으로 오름차순/내림차순
  - **필터**: 컬럼별 필터 입력
  - **가상화**: 대용량 데이터 성능 최적화
  - **고정 컬럼**: 이름 컬럼 좌측 고정

- **상태 표시**:
  - **Chip 컴포넌트**: 상태별 색상 구분
  - **active**: 녹색 배경 + "활성"
  - **suspended**: 빨간색 배경 + "정지"
  - **deleted**: 회색 배경 + "탈퇴"

- **액션 메뉴**:
  - **IconButton**: 더보기 아이콘 (⋯)
  - **Menu**: 클릭 시 액션 옵션 표시
  - **확인 다이얼로그**: 위험한 액션 시 재확인

- **검색 UX**:
  - **TextField**: 검색 아이콘 + 플레이스홀더
  - **Autocomplete**: 최근 검색어 제안
  - **Clear 버튼**: 검색어 초기화

### **4. 샵 관리 화면**

#### **4.1 샵 승인 대기 목록**

#### **화면 구성**
- **대기 중인 신청 카드**
  - 샵 이미지 (메인 이미지)
  - 샵명 및 주소
  - 사장님 정보 (이름, 연락처)
  - 서비스 카테고리
  - 사업자등록번호
  - 신청일 및 대기 기간
  - 승인/거절 버튼

- **문서 검토 영역**
  - 사업자등록증 이미지 뷰어
  - 확대/축소 기능
  - 다운로드 버튼
  - 검토 메모 작성란

#### **백엔드 API 상호작용**
```typescript
// 승인 대기 샵 목록 조회
GET /api/admin/shops/pending
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// 응답 구조
{
  "success": true,
  "pending_shops": [
    {
      "id": "uuid",
      "name": "예쁜손 네일샵",
      "address": "서울시 강남구 역삼동 123-45",
      "main_category": "nail",
      "business_license_number": "123-45-67890",
      "business_license_image_url": "https://storage.url/license.jpg",
      "owner_name": "김사장",
      "owner_email": "owner@example.com",
      "owner_phone": "010-1234-5678",
      "verification_status": "pending",
      "created_at": "2024-03-10T09:00:00Z",
      "waiting_days": 5
    }
  ]
}

// 샵 승인/거절 처리
PUT /api/admin/shops/{shopId}/approve
Headers: { Authorization: "Bearer ${admin_jwt_token}" }
Content-Type: application/json

// 요청 구조
{
  "approved": true,
  "shopType": "partnered",
  "commissionRate": 10.0,
  "notes": "서류 검토 완료. 입점 조건 충족하여 승인 처리합니다."
}

// 응답 구조
{
  "success": true,
  "message": "샵 승인이 완료되었습니다",
  "shop": {
    "id": "uuid",
    "verification_status": "verified",
    "shop_status": "active",
    "shop_type": "partnered",
    "partnership_started_at": "2024-03-15T16:30:00Z"
  },
  "notification_sent": true
}
```

#### **기능 및 로직**
1. **문서 검증 프로세스**
   - 사업자등록증 진위 여부 확인
   - 주소 정보 일치성 검토
   - 사업자 정보 유효성 검증

2. **승인 처리 워크플로우**
   - 승인 시: 샵 상태 'active' 변경
   - 파트너십 타입 설정 (partnered/non_partnered)
   - 수수료율 설정 (기본 10%)
   - 환영 이메일 및 가이드 발송

3. **거절 처리**
   - 거절 사유 선택 (서류 미비, 조건 불충족 등)
   - 거절 메시지 커스터마이징
   - 재신청 가능 여부 안내

#### **UI/UX 구현 상세**
- **카드 레이아웃**: 
  - **좌측**: 샵 이미지 + 기본 정보
  - **중앙**: 사업자 문서 뷰어
  - **우측**: 승인 액션 영역

- **이미지 뷰어**:
  - **확대/축소**: 마우스 휠 또는 버튼
  - **전체화면**: 문서 상세 검토 모드
  - **다운로드**: PDF 또는 이미지 저장

- **승인 버튼**:
  - **승인**: 녹색 Button + 체크 아이콘
  - **거절**: 빨간색 OutlinedButton + X 아이콘
  - **확인 다이얼로그**: 승인/거절 최종 확인

- **메모 시스템**:
  - **TextField**: 검토 메모 작성 (다중 라인)
  - **저장**: 임시 저장 기능
  - **히스토리**: 검토 과정 기록

#### **4.2 활성 샵 관리**

#### **화면 구성**
- **샵 목록 테이블**
  - 샵명 및 카테고리
  - 파트너십 상태 (입점/비입점)
  - 사장님 정보
  - 총 예약 수 및 매출
  - 평점 및 리뷰 수
  - 상태 및 마지막 활동
  - 관리 액션

- **샵 성과 위젯**
  - 월별 매출 차트
  - 예약 현황 그래프
  - 카테고리별 분포
  - 지역별 현황

#### **백엔드 API 상호작용**
```typescript
// 활성 샵 목록 조회
GET /api/admin/shops/active?page=1&limit=50&category=nail&type=partnered&sortBy=revenue&sortOrder=desc
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// 샵 상세 성과 조회
GET /api/admin/shops/{shopId}/analytics?period=30days
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// 샵 설정 업데이트
PUT /api/admin/shops/{shopId}/settings
Headers: { Authorization: "Bearer ${admin_jwt_token}" }
Content-Type: application/json

// 요청 구조
{
  "shop_type": "partnered",
  "commission_rate": 12.0,
  "is_featured": true,
  "featured_until": "2024-04-15T23:59:59Z"
}
```

### **5. 예약 관리 화면**

#### **화면 구성**
- **예약 현황 대시보드**
  - 오늘의 예약 현황 (확정/대기/취소)
  - 시간대별 예약 분포 차트
  - 인기 서비스 순위
  - 평균 예약 금액 추이

- **예약 목록 테이블**
  - 예약자 정보 (이름, 연락처)
  - 샵명 및 서비스
  - 예약 일시
  - 예약 상태 (requested, confirmed, completed, cancelled)
  - 결제 정보 (예약금, 총액)
  - 특별 요청사항
  - 관리 액션

#### **백엔드 API 상호작용**
```typescript
// 예약 목록 조회 (전체 또는 특정 샵)
GET /api/admin/reservations?shopId=uuid&status=confirmed&startDate=2024-03-01&endDate=2024-03-31&page=1&limit=50
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// 응답 구조
{
  "success": true,
  "reservations": [
    {
      "id": "uuid",
      "customer_name": "홍길동",
      "customer_phone": "010-****-5678",
      "shop_name": "예쁜손 네일샵",
      "shop_id": "uuid",
      "service_names": ["젤네일 기본", "네일아트"],
      "reservation_date": "2024-03-20",
      "reservation_time": "14:00",
      "status": "confirmed",
      "total_amount": 85000,
      "deposit_amount": 25000,
      "points_used": 5000,
      "special_requests": "손톱 길이 조절 부탁드려요",
      "created_at": "2024-03-15T10:30:00Z"
    }
  ],
  "summary": {
    "total_count": 156,
    "status_counts": {
      "requested": 12,
      "confirmed": 98,
      "completed": 45,
      "cancelled": 1
    },
    "total_revenue": 8500000
  }
}

// 예약 상태 변경
PUT /api/admin/reservations/{reservationId}/status
Headers: { Authorization: "Bearer ${admin_jwt_token}" }
Content-Type: application/json

// 요청 구조
{
  "status": "confirmed",
  "notes": "고객 요청 사항 확인 완료"
}
```

#### **기능 및 로직**
1. **예약 상태 관리**
   - 상태 변경 권한 확인 (Super Admin: 전체, Shop Owner: 자신의 샵만)
   - 상태 변경 시 고객 알림 자동 발송
   - 취소 시 환불 처리 프로세스 트리거

2. **실시간 모니터링**
   - 예약 현황 실시간 업데이트
   - 노쇼(No-show) 감지 및 알림
   - 긴급 취소 알림

#### **UI/UX 구현 상세**
- **상태 필터**: 
  - **Chip 그룹**: 각 상태별 개수와 함께 표시
  - **클릭 필터**: 상태 클릭 시 해당 예약만 표시
  - **색상 구분**: 상태별 고유 색상 (확정=녹색, 대기=주황, 취소=빨강)

- **예약 상세 모달**:
  - **고객 정보**: 이름, 연락처, 예약 히스토리
  - **서비스 정보**: 선택한 서비스, 가격, 소요시간
  - **결제 정보**: 결제 방법, 결제 상태, 환불 내역
  - **특별 요청**: 고객 요청사항 및 샵 응답

### **6. 결제 및 정산 관리**

#### **화면 구성**
- **결제 개요 대시보드**
  - 일일 거래 현황 (건수, 금액)
  - 결제 수단별 분포 (카드, 간편결제 등)
  - 실패/환불 비율
  - 평균 거래 금액

- **정산 관리 테이블**
  - 샵별 정산 내역
  - 매출액 및 수수료
  - 정산 예정 금액
  - 지급 상태

#### **백엔드 API 상호작용**
```typescript
// 결제 요약 통계
GET /api/admin/payments/summary?startDate=2024-03-01&endDate=2024-03-31&shopId=uuid
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// 응답 구조
{
  "success": true,
  "summary": {
    "total_transactions": 1250,
    "total_amount": 125000000,
    "daily_average": 4032258,
    "payment_methods": {
      "toss_payments": 45.2,
      "kakao_pay": 32.1,
      "card": 22.7
    },
    "success_rate": 98.5,
    "refund_rate": 2.1
  },
  "chart_data": {
    "daily_revenue": [4200000, 3800000, 5100000],
    "payment_trends": [...]
  }
}

// 샵별 정산 내역
GET /api/admin/settlements?period=monthly&status=pending
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// 정산 처리
POST /api/admin/settlements/process
Headers: { Authorization: "Bearer ${admin_jwt_token}" }
Content-Type: application/json

// 요청 구조
{
  "shop_ids": ["uuid1", "uuid2"],
  "settlement_date": "2024-03-31",
  "notes": "3월 정산 처리"
}
```

### **7. 컨텐츠 관리 화면**

#### **7.1 공지사항 관리**

#### **화면 구성**
- **공지사항 목록**
  - 제목 및 내용 요약
  - 대상 사용자 (전체, 일반 사용자, 샵 오너)
  - 중요도 (일반, 중요, 긴급)
  - 발행 상태 (임시저장, 발행, 만료)
  - 발행일 및 조회수
  - 편집/삭제 액션

- **공지사항 작성/편집 폼**
  - 제목 입력
  - 내용 편집기 (리치 텍스트)
  - 대상 설정 (체크박스)
  - 중요도 선택
  - 발행 일정 설정
  - 미리보기 기능

#### **백엔드 API 상호작용**
```typescript
// 공지사항 목록 조회
GET /api/admin/announcements?page=1&limit=20&status=active&target=user
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// 공지사항 생성
POST /api/admin/announcements
Headers: { Authorization: "Bearer ${admin_jwt_token}" }
Content-Type: application/json

// 요청 구조
{
  "title": "에뷰리띵 새로운 기능 업데이트 안내",
  "content": "<p>안녕하세요. 에뷰리띵입니다...</p>",
  "is_important": true,
  "target_user_type": ["user", "shop_owner"],
  "starts_at": "2024-03-16T00:00:00Z",
  "ends_at": "2024-03-30T23:59:59Z"
}

// 공지사항 수정
PUT /api/admin/announcements/{announcementId}
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// 공지사항 삭제
DELETE /api/admin/announcements/{announcementId}
Headers: { Authorization: "Bearer ${admin_jwt_token}" }
```

#### **7.2 FAQ 관리**

#### **화면 구성**
- **FAQ 카테고리 관리**
  - 카테고리 목록 (예약, 포인트, 계정, 기타)
  - 카테고리별 FAQ 수
  - 카테고리 추가/편집/삭제

- **FAQ 목록**
  - 질문 및 답변 요약
  - 카테고리 분류
  - 노출 순서
  - 조회수 및 도움됨 수
  - 활성 상태

#### **백엔드 API 상호작용**
```typescript
// FAQ 목록 조회
GET /api/admin/faqs?category=예약&active=true&sortBy=display_order
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// FAQ 생성/수정
POST /api/admin/faqs
PUT /api/admin/faqs/{faqId}
Headers: { Authorization: "Bearer ${admin_jwt_token}" }
Content-Type: application/json

// 요청 구조
{
  "category": "예약",
  "question": "예약을 취소하고 싶어요",
  "answer": "예약 시간 24시간 전까지는 100% 환불이 가능합니다...",
  "display_order": 1,
  "is_active": true
}
```

### **8. 시스템 설정 화면**

#### **화면 구성**
- **플랫폼 설정**
  - 기본 수수료율 설정
  - 포인트 적립률 설정
  - 예약 취소 정책
  - 이메일 알림 설정

- **관리자 계정 관리**
  - 관리자 목록
  - 권한 설정
  - 새 관리자 추가
  - 비밀번호 재설정

#### **백엔드 API 상호작용**
```typescript
// 시스템 설정 조회
GET /api/admin/settings
Headers: { Authorization: "Bearer ${admin_jwt_token}" }

// 시스템 설정 업데이트
PUT /api/admin/settings
Headers: { Authorization: "Bearer ${admin_jwt_token}" }
Content-Type: application/json

// 요청 구조
{
  "default_commission_rate": 10.0,
  "point_earn_rate": 2.5,
  "point_max_amount": 300000,
  "cancellation_hours": 24,
  "email_notifications_enabled": true
}
```

---

## 🏪 Shop Admin 화면 설계

### **1. Shop Admin 대시보드**

#### **화면 구성**
- **샵 개요 카드**
  - 오늘의 예약 수 (확정/대기)
  - 이번 달 총 매출
  - 평균 평점 및 리뷰 수
  - 이번 달 신규 고객 수

- **오늘의 예약 목록**
  - 시간순 정렬된 예약 리스트
  - 고객명 및 서비스
  - 연락처 (바로 전화 걸기)
  - 특별 요청사항
  - 상태 변경 버튼

- **빠른 액션**
  - 새 서비스 추가
  - 영업시간 변경
  - 임시 휴무 설정
  - 고객 메시지 보기

#### **백엔드 API 상호작용**
```typescript
// Shop Admin 대시보드 데이터
GET /api/admin/shops/my-dashboard
Headers: { Authorization: "Bearer ${shop_admin_jwt_token}" }

// 응답 구조 (Shop Admin용)
{
  "success": true,
  "shop_overview": {
    "shop_id": "uuid",
    "shop_name": "예쁜손 네일샵",
    "todays_reservations": 8,
    "pending_reservations": 2,
    "monthly_revenue": 3200000,
    "average_rating": 4.8,
    "total_reviews": 156,
    "new_customers_this_month": 24
  },
  "todays_schedule": [
    {
      "id": "uuid",
      "customer_name": "홍길동",
      "customer_phone": "010-****-5678",
      "service_names": ["젤네일 기본"],
      "reservation_time": "10:00",
      "status": "confirmed",
      "special_requests": "손톱 길이 조절 부탁드려요"
    }
  ],
  "recent_messages": [
    {
      "customer_name": "김영희",
      "message": "시간 변경이 가능한가요?",
      "timestamp": "2024-03-15T14:30:00Z"
    }
  ]
}
```

### **2. 내 샵 예약 관리**

#### **화면 구성**
- **예약 캘린더 뷰**
  - 월간/주간/일간 보기 옵션
  - 시간대별 예약 슬롯
  - 예약 상태별 색상 구분
  - 드래그 앤 드롭으로 시간 변경

- **예약 상세 관리**
  - 고객 정보 및 연락처
  - 선택한 서비스 및 가격
  - 결제 상태 및 예약금
  - 상태 변경 (확정, 완료, 취소)
  - 고객과의 메시지 교환

#### **백엔드 API 상호작용**
```typescript
// 내 샵 예약 목록 조회
GET /api/admin/reservations/my-shop?date=2024-03-15&status=all
Headers: { Authorization: "Bearer ${shop_admin_jwt_token}" }

// 예약 상태 업데이트 (자신의 샵만)
PUT /api/admin/reservations/{reservationId}/status
Headers: { Authorization: "Bearer ${shop_admin_jwt_token}" }
Content-Type: application/json

// 요청 구조
{
  "status": "confirmed",
  "notes": "고객 요청사항 확인 완료. 예약 확정합니다."
}

// 고객 메시지 발송
POST /api/admin/reservations/{reservationId}/message
Headers: { Authorization: "Bearer ${shop_admin_jwt_token}" }
Content-Type: application/json

// 요청 구조
{
  "message": "안녕하세요. 예약 확정되었습니다. 시간에 맞춰 방문해 주세요."
}
```

### **3. 내 샵 정보 관리**

#### **화면 구성**
- **기본 정보 편집**
  - 샵명 및 설명
  - 주소 및 연락처
  - 영업시간 설정
  - 카카오톡 채널 연결

- **서비스 관리**
  - 제공 서비스 목록
  - 가격 및 소요시간 설정
  - 서비스 이미지 업로드
  - 예약 가능 여부 설정

- **샵 이미지 관리**
  - 메인 이미지 설정
  - 추가 이미지 업로드
  - 이미지 순서 변경
  - 이미지 설명 추가

#### **백엔드 API 상호작용**
```typescript
// 내 샵 정보 조회
GET /api/admin/shops/my-info
Headers: { Authorization: "Bearer ${shop_admin_jwt_token}" }

// 샵 정보 업데이트
PUT /api/admin/shops/my-info
Headers: { Authorization: "Bearer ${shop_admin_jwt_token}" }
Content-Type: application/json

// 요청 구조
{
  "name": "예쁜손 네일샵",
  "description": "트렌디하고 깔끔한 네일아트 전문샵",
  "phone_number": "02-1234-5678",
  "operating_hours": {
    "monday": {"open": "10:00", "close": "22:00"},
    "tuesday": {"open": "10:00", "close": "22:00"},
    "sunday": {"closed": true}
  },
  "kakao_channel_url": "https://pf.kakao.com/..."
}

// 서비스 추가/수정
POST /api/admin/shops/my-services
PUT /api/admin/shops/my-services/{serviceId}
Headers: { Authorization: "Bearer ${shop_admin_jwt_token}" }

// 이미지 업로드
POST /api/admin/shops/my-images
Headers: { 
  Authorization: "Bearer ${shop_admin_jwt_token}",
  Content-Type: "multipart/form-data"
}
```

---

## 🔧 기술적 구현 사항

### **상태 관리 아키텍처**

```typescript
// Redux Store 구성
import { configureStore } from '@reduxjs/toolkit';
import { adminApiSlice } from './api/adminApiSlice';
import authSlice from './slices/authSlice';
import uiSlice from './slices/uiSlice';

export const store = configureStore({
  reducer: {
    auth: authSlice,
    ui: uiSlice,
    api: adminApiSlice.reducer,
  },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware().concat(adminApiSlice.middleware),
});

// RTK Query API 정의
export const adminApiSlice = createApi({
  reducerPath: 'api',
  baseQuery: fetchBaseQuery({
    baseUrl: 'https://api.ebeautything.com/api/admin',
    prepareHeaders: (headers, { getState }) => {
      const token = (getState() as RootState).auth.token;
      if (token) {
        headers.set('authorization', `Bearer ${token}`);
      }
      return headers;
    },
  }),
  tagTypes: ['User', 'Shop', 'Reservation', 'Payment'],
  endpoints: (builder) => ({
    // 사용자 관리 API
    getUsers: builder.query<UsersResponse, UsersQuery>({
      query: (params) => ({
        url: '/users',
        params,
      }),
      providesTags: ['User'],
    }),
    updateUserStatus: builder.mutation<void, UpdateUserStatusRequest>({
      query: ({ userId, ...body }) => ({
        url: `/users/${userId}/status`,
        method: 'PUT',
        body,
      }),
      invalidatesTags: ['User'],
    }),
    // 기타 API 엔드포인트들...
  }),
});
```

### **인증 및 권한 관리**

```typescript
// 인증 슬라이스
const authSlice = createSlice({
  name: 'auth',
  initialState: {
    admin: null as Admin | null,
    token: null as string | null,
    permissions: [] as string[],
    isAuthenticated: false,
  },
  reducers: {
    loginSuccess: (state, action) => {
      state.admin = action.payload.admin;
      state.token = action.payload.token;
      state.permissions = action.payload.permissions;
      state.isAuthenticated = true;
    },
    logout: (state) => {
      state.admin = null;
      state.token = null;
      state.permissions = [];
      state.isAuthenticated = false;
    },
  },
});

// 권한 검사 훅
export const usePermission = () => {
  const permissions = useSelector((state: RootState) => state.auth.permissions);
  
  const hasPermission = useCallback((permission: string) => {
    return permissions.includes(permission);
  }, [permissions]);
  
  const hasAnyPermission = useCallback((requiredPermissions: string[]) => {
    return requiredPermissions.some(permission => permissions.includes(permission));
  }, [permissions]);
  
  return { hasPermission, hasAnyPermission };
};

// 보호된 라우트 컴포넌트
const ProtectedRoute: React.FC<{
  children: React.ReactNode;
  requiredPermissions: string[];
}> = ({ children, requiredPermissions }) => {
  const { hasAnyPermission } = usePermission();
  const isAuthenticated = useSelector((state: RootState) => state.auth.isAuthenticated);
  
  if (!isAuthenticated) {
    return <Navigate to="/login" replace />;
  }
  
  if (!hasAnyPermission(requiredPermissions)) {
    return <AccessDenied />;
  }
  
  return <>{children}</>;
};
```

### **컴포넌트 구조 및 재사용성**

```typescript
// 공통 테이블 컴포넌트
interface DataTableProps<T> {
  data: T[];
  columns: GridColDef[];
  loading?: boolean;
  onRowClick?: (row: T) => void;
  onSelectionChange?: (selection: GridRowSelectionModel) => void;
  pagination?: {
    page: number;
    pageSize: number;
    total: number;
    onPageChange: (page: number) => void;
  };
}

export const DataTable = <T extends Record<string, any>>({
  data,
  columns,
  loading = false,
  onRowClick,
  onSelectionChange,
  pagination,
}: DataTableProps<T>) => {
  return (
    <Box sx={{ height: 600, width: '100%' }}>
      <DataGrid
        rows={data}
        columns={columns}
        loading={loading}
        onRowClick={onRowClick}
        onRowSelectionModelChange={onSelectionChange}
        pagination={pagination ? true : false}
        paginationMode={pagination ? 'server' : 'client'}
        rowCount={pagination?.total}
        page={pagination?.page}
        pageSize={pagination?.pageSize}
        onPageChange={pagination?.onPageChange}
        disableRowSelectionOnClick
        checkboxSelection
        sx={{
          '& .MuiDataGrid-row:hover': {
            backgroundColor: 'action.hover',
          },
        }}
      />
    </Box>
  );
};

// 상태 칩 컴포넌트
interface StatusChipProps {
  status: 'active' | 'inactive' | 'pending' | 'suspended' | 'deleted';
  size?: 'small' | 'medium';
}

const STATUS_CONFIG = {
  active: { label: '활성', color: 'success' as const },
  inactive: { label: '비활성', color: 'default' as const },
  pending: { label: '대기', color: 'warning' as const },
  suspended: { label: '정지', color: 'error' as const },
  deleted: { label: '삭제', color: 'default' as const },
};

export const StatusChip: React.FC<StatusChipProps> = ({ status, size = 'small' }) => {
  const config = STATUS_CONFIG[status];
  
  return (
    <Chip
      label={config.label}
      color={config.color}
      size={size}
      variant="filled"
    />
  );
};
```

### **에러 처리 및 사용자 피드백**

```typescript
// 에러 바운더리
class AdminErrorBoundary extends React.Component<
  { children: React.ReactNode },
  { hasError: boolean; error?: Error }
> {
  constructor(props: any) {
    super(props);
    this.state = { hasError: false };
  }

  static getDerivedStateFromError(error: Error) {
    return { hasError: true, error };
  }

  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {
    console.error('Admin Error:', error, errorInfo);
    // 에러 로깅 서비스로 전송
  }

  render() {
    if (this.state.hasError) {
      return (
        <Box
          sx={{
            display: 'flex',
            flexDirection: 'column',
            alignItems: 'center',
            justifyContent: 'center',
            height: '100vh',
            textAlign: 'center',
          }}
        >
          <Typography variant="h4" gutterBottom>
            오류가 발생했습니다
          </Typography>
          <Typography variant="body1" color="text.secondary" gutterBottom>
            관리자 시스템에 일시적인 문제가 발생했습니다.
          </Typography>
          <Button
            variant="contained"
            onClick={() => window.location.reload()}
            sx={{ mt: 2 }}
          >
            페이지 새로고침
          </Button>
        </Box>
      );
    }

    return this.props.children;
  }
}

// 토스트 알림 훅
export const useToast = () => {
  const showSuccess = useCallback((message: string) => {
    toast.success(message, {
      position: 'top-right',
      duration: 3000,
    });
  }, []);

  const showError = useCallback((message: string) => {
    toast.error(message, {
      position: 'top-right',
      duration: 5000,
    });
  }, []);

  const showInfo = useCallback((message: string) => {
    toast(message, {
      position: 'top-right',
      duration: 4000,
    });
  }, []);

  return { showSuccess, showError, showInfo };
};
```

### **성능 최적화**

```typescript
// 가상화된 테이블 (대용량 데이터용)
const VirtualizedTable = React.memo<{
  data: any[];
  columns: any[];
  height: number;
}>(() => {
  const { height, data, columns } = props;
  
  return (
    <FixedSizeList
      height={height}
      itemCount={data.length}
      itemSize={52}
      overscanCount={5}
    >
      {({ index, style }) => (
        <div style={style}>
          <TableRow data={data[index]} columns={columns} />
        </div>
      )}
    </FixedSizeList>
  );
});

// 이미지 지연 로딩
const LazyImage: React.FC<{ src: string; alt: string }> = ({ src, alt }) => {
  const [loaded, setLoaded] = useState(false);
  const [inView, setInView] = useState(false);
  const imgRef = useRef<HTMLImageElement>(null);

  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setInView(true);
          observer.disconnect();
        }
      },
      { threshold: 0.1 }
    );

    if (imgRef.current) {
      observer.observe(imgRef.current);
    }

    return () => observer.disconnect();
  }, []);

  return (
    <Box ref={imgRef} sx={{ position: 'relative' }}>
      {inView && (
        <>
          {!loaded && <Skeleton variant="rectangular" width="100%" height={200} />}
          <img
            src={src}
            alt={alt}
            onLoad={() => setLoaded(true)}
            style={{
              display: loaded ? 'block' : 'none',
              width: '100%',
              height: 'auto',
            }}
          />
        </>
      )}
    </Box>
  );
};
```

---

## 🎨 디자인 시스템 및 테마

### **Material-UI 테마 설정**

```typescript
// 커스텀 테마 정의
const theme = createTheme({
  palette: {
    primary: {
      main: '#FF6B9D', // 에뷰리띵 브랜드 핑크
      light: '#FFB3D1',
      dark: '#E91E63',
    },
    secondary: {
      main: '#4CAF50',
      light: '#81C784',
      dark: '#388E3C',
    },
    background: {
      default: '#FAFAFA',
      paper: '#FFFFFF',
    },
    text: {
      primary: '#212121',
      secondary: '#757575',
    },
  },
  typography: {
    fontFamily: '"Noto Sans KR", "Roboto", "Helvetica", "Arial", sans-serif',
    h4: {
      fontWeight: 600,
      fontSize: '1.75rem',
    },
    h5: {
      fontWeight: 500,
      fontSize: '1.5rem',
    },
    body1: {
      fontSize: '0.95rem',
      lineHeight: 1.6,
    },
  },
  components: {
    MuiButton: {
      styleOverrides: {
        root: {
          textTransform: 'none',
          borderRadius: 8,
          fontWeight: 500,
        },
      },
    },
    MuiCard: {
      styleOverrides: {
        root: {
          borderRadius: 12,
          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
        },
      },
    },
  },
});

// 다크 모드 지원
const darkTheme = createTheme({
  ...theme,
  palette: {
    ...theme.palette,
    mode: 'dark',
    background: {
      default: '#121212',
      paper: '#1E1E1E',
    },
  },
});
```

---

## 📱 반응형 디자인

### **브레이크포인트 정의**

```typescript
// 반응형 브레이크포인트
const breakpoints = {
  xs: 0,     // 모바일
  sm: 600,   // 작은 태블릿
  md: 960,   // 태블릿
  lg: 1280,  // 데스크톱
  xl: 1920,  // 큰 데스크톱
};

// 반응형 그리드 시스템
const ResponsiveGrid: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  return (
    <Grid container spacing={3}>
      {React.Children.map(children, (child, index) => (
        <Grid
          item
          xs={12}      // 모바일: 전체 너비
          sm={6}       // 태블릿: 절반 너비
          md={4}       // 데스크톱: 1/3 너비
          lg={3}       // 큰 화면: 1/4 너비
          key={index}
        >
          {child}
        </Grid>
      ))}
    </Grid>
  );
};
```

---

## 🚀 배포 및 운영 고려사항

### **환경별 설정 관리**

```typescript
// 환경 설정
const config = {
  development: {
    apiUrl: 'http://localhost:3001/api',
    enableDevTools: true,
    logLevel: 'debug',
  },
  staging: {
    apiUrl: 'https://staging-api.ebeautything.com/api',
    enableDevTools: true,
    logLevel: 'info',
  },
  production: {
    apiUrl: 'https://api.ebeautything.com/api',
    enableDevTools: false,
    logLevel: 'error',
  },
};

export const getConfig = () => {
  const env = process.env.NODE_ENV || 'development';
  return config[env as keyof typeof config];
};
```

### **성능 모니터링**

```typescript
// 성능 메트릭 수집
export const performanceMonitor = {
  trackPageLoad: (pageName: string) => {
    const startTime = performance.now();
    
    return () => {
      const endTime = performance.now();
      const loadTime = endTime - startTime;
      
      // 분석 서비스로 전송
      analytics.track('page_load', {
        page: pageName,
        loadTime: loadTime,
        timestamp: new Date().toISOString(),
      });
    };
  },
  
  trackAPICall: (endpoint: string, method: string) => {
    const startTime = performance.now();
    
    return (success: boolean) => {
      const endTime = performance.now();
      const responseTime = endTime - startTime;
      
      analytics.track('api_call', {
        endpoint,
        method,
        responseTime,
        success,
        timestamp: new Date().toISOString(),
      });
    };
  },
};
```

---

이 설계서는 에뷰리띵 웹 관리자 플랫폼의 모든 화면과 기능에 대한 포괄적인 가이드를 제공합니다. Super Admin과 Shop Admin의 차별화된 기능, Node.js 백엔드 API와의 연동, 그리고 현대적인 웹 기술을 활용한 구현 방법을 상세히 설명하여 개발 시 참고할 수 있도록 구성되었습니다. 